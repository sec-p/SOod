
================================================================================
Starting training: all_selectors_fuser_self_attn (seed=42)
================================================================================

Setting up data...
Using mixed data loading: FA for training, MCM for testing/OOD
✓ Loaded 1000 class names from /root/SOod/src/../data/ImageNet/imagenet_class_clean.npy
⚠ FA's data loader not available, using MCM's ImageFolder implementation
  ✓ Loaded OOD dataset: iNaturalist
  ✓ Loaded OOD dataset: SUN
  ✓ Loaded OOD dataset: Places
  ⚠ Failed to load OOD dataset Textures: [Errno 2] No such file or directory: '/root/autodl-tmp/Texture/images'
Setting up model...
Config: {
  "device": "cuda",
  "selector_type": "all",
  "num_select": 40,
  "fuser_type": "self_attn",
  "lambda_llm_negatives": 0.5,
  "lambda_mixup": 0.1,
  "margin": 0.5,
  "selector_temperature": 1.0,
  "patches_per_slot_attn": 16,
  "templates": [
    "a photo of the {}."
  ],
  "use_redundancy_loss": true,
  "use_llm_negatives": true,
  "use_semantic_exclusion": true,
  "use_mixup_invariance": true,
  "lambda_redundancy": 0.1
}
